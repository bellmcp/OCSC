{"ast":null,"code":"import _regeneratorRuntime from\"/Users/ninew/Documents/GitHub/OCSC/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/Users/ninew/Documents/GitHub/OCSC/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"/Users/ninew/Documents/GitHub/OCSC/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/ninew/Documents/GitHub/OCSC/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import Box from'@material-ui/core/Box';import Container from'@material-ui/core/Container';import Grid from'@material-ui/core/Grid';import Paper from'@material-ui/core/Paper';import AgeChart from'../../Chart/AgeChart';import EducationChart from'../../Chart/EduChart';import BrChart from'../../Chart/BrChart';import GndrChart from'../../Chart/GndrChart';import InputDate from'../../component/admin/InputDate';import'../../index.css';import get from'../../service/getStatic';import Modal from'../../component/admin/Modals';import jsPDF from'jspdf';import html2canvas from'html2canvas';import CloudDownloadOutlinedIcon from'@material-ui/icons/CloudDownloadOutlined';import domtoimage from'dom-to-image';import Button from'@material-ui/core/Button';export default function Dashboard(){var classes=useStyles();var today=new Date();var dd=String(today.getDate()).padStart(2,'0');var mm=String(today.getMonth()+1).padStart(2,'0');//January is 0!\nvar yyyy=today.getFullYear();today=mm+'-'+dd+'-'+yyyy;var _useState=useState({startdate:'2020-01-01',enddate:today}),_useState2=_slicedToArray(_useState,2),date=_useState2[0],setDate=_useState2[1];var _useState3=useState({gender:[0,0],age:[0,0,0,0,0,0],education:[0,0,0,0,0,0,0,0,0,0,0,0,0],major:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}),_useState4=_slicedToArray(_useState3,2),statistic=_useState4[0],setStatistic=_useState4[1];var _useState5=useState({status:200,fetch:true,text:'ok'}),_useState6=_slicedToArray(_useState5,2),stat=_useState6[0],setStatus=_useState6[1];var onSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var result,newStatus,newArray;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return get(date.startdate,date.enddate);case 2:result=_context.sent;newStatus=stat;if(result===404){newStatus.status=404;newStatus.text='หาไม่พบ';setStatus(newStatus);}if(result===500){newStatus.status=500;newStatus.text='โปรแกรมผิดพลาด';setStatus(newStatus);}if(result===999){newStatus.status=999;newStatus.text='เกิดความผิดพลาด';setStatus(newStatus);}if(result!==404||result!==500||result!==501){newArray=statistic;newArray.gender=result.gndr;newArray.age=result.age;newArray.education=result.edu;newArray.major=result.maj;setStatistic(newArray);setStatistic(_objectSpread({},statistic));}case 8:case\"end\":return _context.stop();}}},_callee);}));return function onSubmit(){return _ref.apply(this,arguments);};}();var url='https://cubioinfo.com/aptitude-test/api/statistics/'+date.startdate+'/'+date.enddate;var loadFont=function loadFont(url){var xhr=new XMLHttpRequest();xhr.open('GET',url,true);xhr.onreadystatechange=function(){if(xhr.readyState===4&&xhr.status===200){var css=xhr.responseText;css=css.replace(/}/g,'font-display: swap; }');var head=document.getElementsByTagName('head')[0];var style=document.createElement('style');style.appendChild(document.createTextNode(css));head.appendChild(style);}};xhr.send();};return/*#__PURE__*/React.createElement(Container,{maxWidth:\"lg\",className:classes.container},/*#__PURE__*/React.createElement(InputDate,{date:date,setDate:setDate,onSubmit:onSubmit}),loadFont('https://fonts.googleapis.com/css2?family=Prompt:wght@300&display=swap'),/*#__PURE__*/React.createElement(Grid,{container:true,xs:12,direction:\"row\",justify:\"flex-end\",alignItems:\"center\"},/*#__PURE__*/React.createElement(Button,{style:{background:'none'},alignItems:\"left\",onClick:function onClick(){var input=document.getElementById('page');html2canvas(input).then(function(canvas){// eslint-disable-next-line\nvar imgData=canvas.toDataURL('image/png');var pdf=new jsPDF();var scale=3;var style={transform:'scale('+scale+')',transformOrigin:'top left',width:input.offsetWidth+'px',height:input.offsetHeight+'px'};var param={height:input.offsetHeight*scale,width:input.offsetWidth*scale,quality:1,style:style};if(pdf){domtoimage.toPng(input,param).then(function(imgData){setTimeout(function(){pdf.addImage(imgData,'PNG',35,10,140,270);window.open(pdf.output('bloburl'),'_blank');pdf.save('สถิติการประเมินผล.pdf');},950);});}});},className:classes.button},/*#__PURE__*/React.createElement(CloudDownloadOutlinedIcon,{style:{color:'slategray',fontSize:'40px'}}))),/*#__PURE__*/React.createElement(\"div\",{id:\"page\"},stat.status===404||stat.status===500||stat.status===501?/*#__PURE__*/React.createElement(Modal,{status:stat.status,link:url}):'',stat.status===999?/*#__PURE__*/React.createElement(Modal,{status:' failed to fetch',link:'Something happened in setting up the request and triggered an Error'}):'',/*#__PURE__*/React.createElement(Grid,{container:true,spacing:1},/*#__PURE__*/React.createElement(Grid,{item:true,xs:12},/*#__PURE__*/React.createElement(Paper,null,/*#__PURE__*/React.createElement(Box,{p:2},stat.status===404||stat.status===500||stat.status===501?'':/*#__PURE__*/React.createElement(GndrChart,{gender:statistic})))),/*#__PURE__*/React.createElement(Grid,{item:true,xs:12},/*#__PURE__*/React.createElement(Paper,null,/*#__PURE__*/React.createElement(Box,{p:2},stat.status===404||stat.status===500||stat.status===501?'':/*#__PURE__*/React.createElement(AgeChart,{age:statistic})))),/*#__PURE__*/React.createElement(Grid,{item:true,xs:12},/*#__PURE__*/React.createElement(Paper,null,/*#__PURE__*/React.createElement(Box,{p:2},stat.status===404||stat.status===500||stat.status===501?'':/*#__PURE__*/React.createElement(EducationChart,{edu:statistic}))))),/*#__PURE__*/React.createElement(Box,{pt:4},/*#__PURE__*/React.createElement(Paper,{className:fixedHeightPaper},/*#__PURE__*/React.createElement(Box,{p:2,xs:12,lg:12},stat.status===404||stat.status===500||stat.status===501?'':/*#__PURE__*/React.createElement(BrChart,{br:statistic}))))));}","map":{"version":3,"sources":["/Users/ninew/Documents/GitHub/OCSC/src/component/admin/static.js"],"names":["React","useState","Box","Container","Grid","Paper","AgeChart","EducationChart","BrChart","GndrChart","InputDate","get","Modal","jsPDF","html2canvas","CloudDownloadOutlinedIcon","domtoimage","Button","Dashboard","classes","useStyles","today","Date","dd","String","getDate","padStart","mm","getMonth","yyyy","getFullYear","startdate","enddate","date","setDate","gender","age","education","major","statistic","setStatistic","status","fetch","text","stat","setStatus","onSubmit","result","newStatus","newArray","gndr","edu","maj","url","loadFont","xhr","XMLHttpRequest","open","onreadystatechange","readyState","css","responseText","replace","head","document","getElementsByTagName","style","createElement","appendChild","createTextNode","send","container","background","input","getElementById","then","canvas","imgData","toDataURL","pdf","scale","transform","transformOrigin","width","offsetWidth","height","offsetHeight","param","quality","toPng","setTimeout","addImage","window","output","save","button","color","fontSize","fixedHeightPaper"],"mappings":"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","sourcesContent":["import React, { useState } from 'react'\n\nimport Box from '@material-ui/core/Box'\nimport Container from '@material-ui/core/Container'\nimport Grid from '@material-ui/core/Grid'\nimport Paper from '@material-ui/core/Paper'\n\n\nimport AgeChart from '../../Chart/AgeChart'\nimport EducationChart from '../../Chart/EduChart'\nimport BrChart from '../../Chart/BrChart'\nimport GndrChart from '../../Chart/GndrChart'\n\nimport InputDate from '../../component/admin/InputDate'\n\nimport '../../index.css'\nimport get from '../../service/getStatic'\nimport Modal from '../../component/admin/Modals'\n\nimport jsPDF from 'jspdf'\nimport html2canvas from 'html2canvas'\nimport CloudDownloadOutlinedIcon from '@material-ui/icons/CloudDownloadOutlined'\nimport domtoimage from 'dom-to-image'\nimport Button from '@material-ui/core/Button'\n\n\n\nexport default function Dashboard() {\n  const classes = useStyles()\n\n  var today = new Date()\n  var dd = String(today.getDate()).padStart(2, '0')\n  var mm = String(today.getMonth() + 1).padStart(2, '0') //January is 0!\n  var yyyy = today.getFullYear()\n\n  today = mm + '-' + dd + '-' + yyyy\n\n  const [date, setDate] = useState({\n    startdate: '2020-01-01',\n    enddate: today,\n  })\n  const [statistic, setStatistic] = useState({\n    gender: [0, 0],\n    age: [0, 0, 0, 0, 0, 0],\n    education: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n    major: [\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n    ],\n  })\n  const [stat, setStatus] = useState({\n    status: 200,\n    fetch: true,\n    text: 'ok',\n  })\n  const onSubmit = async () => {\n    const result = await get(date.startdate, date.enddate)\n    const newStatus = stat\n\n    if (result === 404) {\n      newStatus.status = 404\n      newStatus.text = 'หาไม่พบ'\n      setStatus(newStatus)\n    }\n    if (result === 500) {\n      newStatus.status = 500\n      newStatus.text = 'โปรแกรมผิดพลาด'\n      setStatus(newStatus)\n    }\n    if (result === 999) {\n      newStatus.status = 999\n      newStatus.text = 'เกิดความผิดพลาด'\n      setStatus(newStatus)\n    }\n    if (result !== 404 || result !== 500 || result !== 501) {\n      const newArray = statistic\n      newArray.gender = result.gndr\n      newArray.age = result.age\n      newArray.education = result.edu\n      newArray.major = result.maj\n      setStatistic(newArray)\n      setStatistic({ ...statistic })\n    }\n  }\n  const url =\n    'https://cubioinfo.com/aptitude-test/api/statistics/' +\n    date.startdate +\n    '/' +\n    date.enddate\n  const loadFont = (url) => {\n    var xhr = new XMLHttpRequest()\n    xhr.open('GET', url, true)\n    xhr.onreadystatechange = () => {\n      if (xhr.readyState === 4 && xhr.status === 200) {\n        let css = xhr.responseText\n        css = css.replace(/}/g, 'font-display: swap; }')\n\n        const head = document.getElementsByTagName('head')[0]\n        const style = document.createElement('style')\n        style.appendChild(document.createTextNode(css))\n        head.appendChild(style)\n      }\n    }\n    xhr.send()\n  }\n  return (\n\n        <Container maxWidth=\"lg\" className={classes.container}>\n          <InputDate date={date} setDate={setDate} onSubmit={onSubmit} />\n          {loadFont(\n        'https://fonts.googleapis.com/css2?family=Prompt:wght@300&display=swap',\n      )}\n          <Grid\n            container\n            xs={12}\n            direction=\"row\"\n            justify=\"flex-end\"\n            alignItems=\"center\"\n          >\n            <Button\n              style={{\n                background: 'none',\n              }}\n              alignItems=\"left\"\n              onClick={() => {\n                const input = document.getElementById('page')\n                html2canvas(input).then((canvas) => {\n                  // eslint-disable-next-line\n                  const imgData = canvas.toDataURL('image/png')\n                  const pdf = new jsPDF()\n                  const scale = 3\n                  const style = {\n                    transform: 'scale(' + scale + ')',\n                    transformOrigin: 'top left',\n                    width: input.offsetWidth + 'px',\n                    height: input.offsetHeight + 'px',\n                  }\n                  const param = {\n                    height: input.offsetHeight * scale,\n                    width: input.offsetWidth * scale,\n                    quality: 1,\n                    style,\n                  }\n                  if (pdf) {\n                    domtoimage.toPng(input, param).then((imgData) => {\n                      setTimeout(function () {\n                        pdf.addImage(imgData, 'PNG', 35, 10, 140, 270)\n                        window.open(pdf.output('bloburl'), '_blank')\n                        pdf.save('สถิติการประเมินผล.pdf')\n                      }, 950)\n                    })\n                  }\n                })\n              }}\n              className={classes.button}\n            >\n              <CloudDownloadOutlinedIcon\n                style={{ color: 'slategray', fontSize: '40px' }}\n              />\n            </Button>\n          </Grid>\n\n          <div id=\"page\">\n            {stat.status === 404 ||\n            stat.status === 500 ||\n            stat.status === 501 ? (\n              <Modal status={stat.status} link={url} />\n            ) : (\n              ''\n            )}\n            {stat.status === 999 ? (\n              <Modal\n                status={' failed to fetch'}\n                link={\n                  'Something happened in setting up the request and triggered an Error'\n                }\n              />\n            ) : (\n              ''\n            )}\n            <Grid container spacing={1}>\n              {/* Chart */}\n              <Grid item xs={12}>\n                <Paper>\n                  <Box p={2}>\n                    {stat.status === 404 ||\n                    stat.status === 500 ||\n                    stat.status === 501 ? (\n                      ''\n                    ) : (\n                      <GndrChart gender={statistic} />\n                    )}\n                  </Box>\n                </Paper>\n              </Grid>\n              {/* Recent Deposits */}\n              <Grid item xs={12}>\n                <Paper>\n                  <Box p={2}>\n                    {stat.status === 404 ||\n                    stat.status === 500 ||\n                    stat.status === 501 ? (\n                      ''\n                    ) : (\n                      <AgeChart age={statistic} />\n                    )}\n                  </Box>\n                </Paper>\n              </Grid>\n              {/* Recent Orders */}\n              <Grid item xs={12}>\n                <Paper>\n                  <Box p={2}>\n                    {stat.status === 404 ||\n                    stat.status === 500 ||\n                    stat.status === 501 ? (\n                      ''\n                    ) : (\n                      <EducationChart edu={statistic} />\n                    )}\n                  </Box>\n                </Paper>\n              </Grid>\n            </Grid>\n            <Box pt={4}>\n              <Paper className={fixedHeightPaper}>\n                <Box p={2} xs={12} lg={12}>\n                  {stat.status === 404 ||\n                  stat.status === 500 ||\n                  stat.status === 501 ? (\n                    ''\n                  ) : (\n                    <BrChart br={statistic} />\n                  )}\n                </Box>\n              </Paper>\n            </Box>\n          </div>\n        </Container>\n     \n  )\n}\n"]},"metadata":{},"sourceType":"module"}