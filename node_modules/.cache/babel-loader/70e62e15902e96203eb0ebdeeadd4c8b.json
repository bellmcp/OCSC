{"ast":null,"code":"import React, { useState, useEffect, useContext } from 'react';\nimport { Route, Redirect } from 'react-router-dom';\nvar Auth = React.createContext(null);\nvar AuthContextProvider = Auth.Provider;\nvar AuthContext = Auth;\n\nvar TokenObject = /*#__PURE__*/function () {\n  function TokenObject(tokenName) {\n    this.tokenName = tokenName;\n  }\n\n  var _proto = TokenObject.prototype;\n\n  _proto.isTokenExpire = function isTokenExpire() {\n    if (this.isTokenExist()) {\n      var _e = JSON.parse(localStorage[this.tokenName]).expiresAt;\n      return _e < new Date();\n    } else {\n      return true;\n    }\n  };\n\n  _proto.isTokenExist = function isTokenExist() {\n    return localStorage[this.tokenName] !== undefined;\n  };\n\n  _proto.setToken = function setToken(value, expiresAt, state) {\n    var json = {\n      value: value,\n      expiresAt: expiresAt,\n      state: state\n    };\n    localStorage[this.tokenName] = JSON.stringify(json);\n  };\n\n  _proto.getToken = function getToken() {\n    if (this.isTokenExist()) {\n      if (!this.isTokenExpire()) {\n        var _t = JSON.parse(localStorage[this.tokenName]);\n\n        var token = _t.value;\n        var expiresAt = _t.expiresAt;\n        var state = _t.state;\n        return {\n          authToken: token,\n          expireAt: expiresAt,\n          state: state\n        };\n      } else {\n        return {\n          authToken: null,\n          expireAt: null,\n          state: null\n        };\n      }\n    } else {\n      return {\n        authToken: null,\n        expireAt: null,\n        state: null\n      };\n    }\n  };\n\n  _proto.removeToken = function removeToken() {\n    localStorage.removeItem(this.tokenName);\n  };\n\n  return TokenObject;\n}();\n\nvar AuthProvider = function AuthProvider(_ref) {\n  var cookieName = _ref.cookieName,\n      children = _ref.children;\n  var JwtToken = new TokenObject(cookieName);\n\n  var _useState = useState(JwtToken.getToken()),\n      authObject = _useState[0],\n      setAuthObject = _useState[1];\n\n  useEffect(function () {\n    if (authObject.authToken === undefined || authObject.authToken === null || authObject.expireAt === null) {\n      JwtToken.removeToken();\n    } else {\n      JwtToken.setToken(authObject.authToken, authObject.expireAt, authObject.state);\n    }\n  }, [authObject]);\n  return /*#__PURE__*/React.createElement(AuthContextProvider, {\n    value: {\n      authObject: authObject,\n      setAuthToken: setAuthObject\n    }\n  }, children);\n};\n\nAuthProvider.defaultProps = {\n  cookieName: \"_authUser\"\n};\n\nvar isAuth = function isAuth() {\n  var value = useContext(AuthContext);\n\n  if ((value === null || value === void 0 ? void 0 : value.authObject.authToken) && (value === null || value === void 0 ? void 0 : value.authObject.expireAt)) {\n    if (value.authObject.expireAt < new Date()) {\n      return {\n        auth: true,\n        authToken: value.authObject.authToken\n      };\n    } else {\n      value.setAuthToken({\n        authToken: null,\n        expireAt: null,\n        state: null\n      });\n      return {\n        auth: false,\n        authToken: null\n      };\n    }\n  } else {\n    return {\n      auth: false,\n      authToken: null\n    };\n  }\n};\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nvar PrivateRoute = function PrivateRoute(_ref) {\n  var Component = _ref.component,\n      loginPath = _ref.loginPath,\n      rest = _objectWithoutPropertiesLoose(_ref, [\"component\", \"loginPath\"]);\n\n  var _authContext = useContext(AuthContext);\n\n  var isAuth = function isAuth() {\n    if ((_authContext === null || _authContext === void 0 ? void 0 : _authContext.authObject.authToken) && (_authContext === null || _authContext === void 0 ? void 0 : _authContext.authObject.expireAt)) {\n      if (_authContext.authObject.expireAt < new Date()) {\n        return {\n          auth: true,\n          authToken: _authContext.authObject.authToken\n        };\n      } else {\n        _authContext.setAuthToken({\n          authToken: null,\n          expireAt: null,\n          state: null\n        });\n\n        return {\n          auth: false,\n          authToken: null\n        };\n      }\n    } else {\n      return {\n        auth: false,\n        authToken: null\n      };\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(Route, _extends({}, rest, {\n    render: function render(props) {\n      return isAuth().auth ? /*#__PURE__*/React.createElement(Component, props) : /*#__PURE__*/React.createElement(Redirect, {\n        to: loginPath\n      });\n    }\n  }));\n};\n\nvar loginAuth = function loginAuth(token, expiresIn, state) {\n  var expTime = new Date(new Date().getTime() + expiresIn * 60 * 1000);\n\n  try {\n    var c = useContext(AuthContext);\n    c.setAuthToken({\n      authToken: token,\n      expireAt: expTime,\n      state: state\n    });\n    return true;\n  } catch (e) {\n    console.error(e);\n    return false;\n  }\n};\n\nvar logoutAuth = function logoutAuth() {\n  try {\n    var c = useContext(AuthContext);\n\n    if (c === null || c === void 0 ? void 0 : c.authObject.authToken) {\n      c.setAuthToken({\n        authToken: null,\n        expireAt: null,\n        state: null\n      });\n      return true;\n    } else {\n      return false;\n    }\n  } catch (e) {\n    console.error(e);\n    return false;\n  }\n};\n\nvar authHeader = function authHeader() {\n  var c = useContext(AuthContext);\n\n  if (c.authObject.authToken) {\n    return \"Bearer \" + c.authObject.authToken;\n  } else {\n    return null;\n  }\n};\n\nexport { AuthProvider, PrivateRoute, authHeader, isAuth, loginAuth, logoutAuth };","map":{"version":3,"sources":["../src/AuthContext.js","../src/TokenObject.js","../src/AuthProvider.js","../src/isAuth.js","../src/PrivateRoute.js","../src/doAuth.js","../src/authHeader.js"],"names":["Auth","React","AuthContextProvider","AuthContext","TokenObject","isTokenExpire","_e","JSON","localStorage","isTokenExist","setToken","json","value","expiresAt","state","getToken","_t","token","authToken","expireAt","removeToken","AuthProvider","cookieName","children","JwtToken","authObject","setAuthObject","useState","useEffect","setAuthToken","isAuth","useContext","auth","PrivateRoute","component","Component","loginPath","rest","_authContext","loginAuth","expTime","expiresIn","c","console","logoutAuth","authHeader"],"mappings":"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","sourcesContent":["/*\r\n * Copyright 2020. Arkadip Bhattacharya\r\n *\r\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\r\n *  you may not use this file except in compliance with the License.\r\n *  You may obtain a copy of the License at\r\n *\r\n *  http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n *  Unless required by applicable law or agreed to in writing, software\r\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\r\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n *   See the License for the specific language governing permissions and\r\n *   limitations under the License.\r\n */\r\n\r\nimport React from 'react'\r\n\r\n/**\r\n * Initialized Auth Context\r\n */\r\nconst Auth = React.createContext(null)\r\n\r\nexport const AuthContextProvider = Auth.Provider\r\nexport const AuthContext = Auth\r\n","/*\r\n * Copyright 2020. Arkadip Bhattacharya\r\n *\r\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\r\n *  you may not use this file except in compliance with the License.\r\n *  You may obtain a copy of the License at\r\n *\r\n *  http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n *  Unless required by applicable law or agreed to in writing, software\r\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\r\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n *   See the License for the specific language governing permissions and\r\n *   limitations under the License.\r\n */\r\n\r\n/**\r\n * Token Object Class\r\n */\r\nclass TokenObject {\r\n  /**\r\n   * @constructor\r\n   * @param tokenName - Name of the token\r\n   */\r\n  constructor(tokenName) {\r\n    this.tokenName = tokenName\r\n  }\r\n\r\n  /**\r\n   * Checks if the token is expired or not\r\n   * @returns {boolean} true: if the token is expired\r\n   */\r\n  isTokenExpire() {\r\n    if (this.isTokenExist()) {\r\n      const _e = JSON.parse(localStorage[this.tokenName]).expiresAt\r\n      return _e < new Date()\r\n    } else {\r\n      return true\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @returns {boolean} true: if the token exists\r\n   */\r\n  isTokenExist() {\r\n    return localStorage[this.tokenName] !== undefined\r\n  }\r\n\r\n  /**\r\n   * Set Token\r\n   * @param value\r\n   * @param expiresAt\r\n   */\r\n  setToken(value, expiresAt, state) {\r\n    // {value: xxx, expiresAt: ttt, state: {}}\r\n    const json = { value: value, expiresAt: expiresAt, state: state }\r\n    localStorage[this.tokenName] = JSON.stringify(json)\r\n  }\r\n\r\n  /**\r\n   * Get the current token\r\n   * @returns {{authToken: token, expireAt: Date, state: Object}|{authToken: null, expireAt: null, state: null}}\r\n   */\r\n  getToken() {\r\n    if (this.isTokenExist()) {\r\n      if (!this.isTokenExpire()) {\r\n        const _t = JSON.parse(localStorage[this.tokenName])\r\n        const token = _t.value\r\n        const expiresAt = _t.expiresAt\r\n        const state = _t.state\r\n        return { authToken: token, expireAt: expiresAt, state: state }\r\n      } else {\r\n        return { authToken: null, expireAt: null, state: null }\r\n      }\r\n    } else {\r\n      return { authToken: null, expireAt: null, state: null }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Remove the Token\r\n   */\r\n  removeToken() {\r\n    localStorage.removeItem(this.tokenName)\r\n  }\r\n}\r\n\r\nexport default TokenObject\r\n","/*\r\n * Copyright 2020. Arkadip Bhattacharya\r\n *\r\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\r\n *  you may not use this file except in compliance with the License.\r\n *  You may obtain a copy of the License at\r\n *\r\n *  http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n *  Unless required by applicable law or agreed to in writing, software\r\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\r\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n *   See the License for the specific language governing permissions and\r\n *   limitations under the License.\r\n */\r\n\r\nimport React, { useState, useEffect } from 'react'\r\nimport { AuthContextProvider } from './AuthContext'\r\nimport TokenObject from './TokenObject'\r\n\r\n/**\r\n * AuthProvider, Context provider that passes the auth down to the components\r\n * @param cookieName - Name of the auth Cookie. Default: '_authUser'\r\n * @param children - React.Component | React.FunctionalComponent\r\n * @constructor\r\n */\r\nconst AuthProvider = ({ cookieName, children }) => {\r\n  const JwtToken = new TokenObject(cookieName)\r\n\r\n  const [authObject, setAuthObject] = useState(JwtToken.getToken())\r\n  useEffect(() => {\r\n    if (\r\n      authObject.authToken === undefined ||\r\n      authObject.authToken === null ||\r\n      authObject.expireAt === null\r\n    ) {\r\n      JwtToken.removeToken()\r\n    } else {\r\n      JwtToken.setToken(authObject.authToken, authObject.expireAt, authObject.state)\r\n    }\r\n  }, [authObject])\r\n\r\n  return (\r\n    <AuthContextProvider\r\n      value={{ authObject: authObject, setAuthToken: setAuthObject }}\r\n    >\r\n      {children}\r\n    </AuthContextProvider>\r\n  )\r\n}\r\n\r\nAuthProvider.defaultProps = {\r\n  cookieName: `_authUser`\r\n}\r\n\r\nexport default AuthProvider\r\n","/*\r\n * Copyright 2020. Arkadip Bhattacharya\r\n *\r\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\r\n *  you may not use this file except in compliance with the License.\r\n *  You may obtain a copy of the License at\r\n *\r\n *  http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n *  Unless required by applicable law or agreed to in writing, software\r\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\r\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n *   See the License for the specific language governing permissions and\r\n *   limitations under the License.\r\n */\r\n\r\nimport { useContext } from 'react'\r\nimport { AuthContext } from './AuthContext'\r\n\r\n/**\r\n * Checks if the USER is logged in or not\r\n * @returns {{auth: boolean, authToken: string | null}} AuthObject\r\n */\r\n\r\nconst isAuth = () => {\r\n  const value = useContext(AuthContext)\r\n  if (value?.authObject.authToken && value?.authObject.expireAt) {\r\n    if (value.authObject.expireAt < new Date()) {\r\n      return { auth: true, authToken: value.authObject.authToken }\r\n    } else {\r\n      value.setAuthToken({ authToken: null, expireAt: null, state: null })\r\n      return { auth: false, authToken: null }\r\n    }\r\n  } else {\r\n    return { auth: false, authToken: null }\r\n  }\r\n}\r\n\r\nexport default isAuth\r\n","/*\r\n * Copyright 2020. Arkadip Bhattacharya\r\n *\r\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\r\n *  you may not use this file except in compliance with the License.\r\n *  You may obtain a copy of the License at\r\n *\r\n *  http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n *  Unless required by applicable law or agreed to in writing, software\r\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\r\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n *   See the License for the specific language governing permissions and\r\n *   limitations under the License.\r\n */\r\n\r\nimport React, { useContext } from 'react'\r\nimport { Route, Redirect } from 'react-router-dom'\r\nimport { AuthContext } from './AuthContext'\r\n\r\n/**\r\n *\r\n * @param component - Component to Route\r\n * @param loginPath - Login Page path\r\n * @param path - Path of the Coponent\r\n * @param rest - Other Things\r\n */\r\nconst PrivateRoute = ({ component: Component, loginPath: loginPath, ...rest }) => {\r\n  const _authContext = useContext(AuthContext)\r\n  \r\n  const isAuth = () => {\r\n    if (_authContext?.authObject.authToken && _authContext?.authObject.expireAt) {\r\n      if (_authContext.authObject.expireAt < new Date()) {\r\n        return { auth: true, authToken: _authContext.authObject.authToken }\r\n      } else {\r\n        _authContext.setAuthToken({ authToken: null, expireAt: null, state: null })\r\n        return { auth: false, authToken: null }\r\n      }\r\n    } else {\r\n      return { auth: false, authToken: null }\r\n    }\r\n  }\r\n\r\n  return (\r\n    <Route\r\n      {...rest}\r\n      render={(props) =>\r\n        isAuth().auth ? <Component {...props} /> : <Redirect to={loginPath} />\r\n      }\r\n    />\r\n  )\r\n}\r\n\r\nexport default PrivateRoute\r\n","/*\r\n * Copyright 2020. Arkadip Bhattacharya\r\n *\r\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\r\n *  you may not use this file except in compliance with the License.\r\n *  You may obtain a copy of the License at\r\n *\r\n *  http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n *  Unless required by applicable law or agreed to in writing, software\r\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\r\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n *   See the License for the specific language governing permissions and\r\n *   limitations under the License.\r\n */\r\n\r\nimport { useContext } from 'react'\r\nimport { AuthContext } from './AuthContext'\r\n\r\n/**\r\n * Auth Login function\r\n * @param {string} token - Token from the backend server\r\n * @param {number} expiresIn - Time takes to expires a token in minutes\r\n * @param {Object} state - User state\r\n * @returns {boolean} - success status\r\n */\r\nexport const loginAuth = (token, expiresIn, state) => {\r\n  const expTime = new Date(new Date().getTime() + expiresIn * 60 * 1000)\r\n\r\n  try {\r\n    const c = useContext(AuthContext)\r\n    c.setAuthToken({ authToken: token, expireAt: expTime, state: state })\r\n    return true\r\n  } catch (e) {\r\n    console.error(e)\r\n    return false\r\n  }\r\n}\r\n\r\n/**\r\n * Auth Logout Function\r\n * @returns {boolean} - success status\r\n */\r\nexport const logoutAuth = () => {\r\n  try {\r\n    const c = useContext(AuthContext)\r\n    if (c?.authObject.authToken) {\r\n      c.setAuthToken({ authToken: null, expireAt: null, state: null })\r\n      return true\r\n    } else {\r\n      return false\r\n    }\r\n  } catch (e) {\r\n    console.error(e)\r\n    return false\r\n  }\r\n}\r\n","/*\r\n * Copyright 2020. Arkadip Bhattacharya\r\n *\r\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\r\n *  you may not use this file except in compliance with the License.\r\n *  You may obtain a copy of the License at\r\n *\r\n *  http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n *  Unless required by applicable law or agreed to in writing, software\r\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\r\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n *   See the License for the specific language governing permissions and\r\n *   limitations under the License.\r\n */\r\n\r\nimport { useContext } from 'react'\r\nimport { AuthContext } from './AuthContext'\r\n\r\nconst authHeader = () => {\r\n  const c = useContext(AuthContext)\r\n  if (c.authObject.authToken) {\r\n    return `Bearer ${c.authObject.authToken}`\r\n  } else {\r\n    return null\r\n  }\r\n}\r\n\r\nexport default authHeader\r\n"]},"metadata":{},"sourceType":"module"}